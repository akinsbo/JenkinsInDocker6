#version: "3.2"
#
#services:
#    jenkinsdata:
#        build: jenkins-data
#        volumes:
#            - data-volume:/var/log/jenkins
##            - data-volume:/var/jenkins_home
#
#    jenkinsmaster:
#        build: jenkins-master
#        volumes:
#            - ./data-volume:/var/log/jenkins
#        ports:
#            - "50004:50000"
#
#    jenkinsnginx:
#        build: jenkins-nginx
#        ports:
#            - "84:80"
##        depends_on:
##            - jenkinsmaster
#        links:
#            #set the url of access of jenkins-master
#            - jenkinsmaster:jenkins-master
#
#volumes:
#    data-volume:

data:
 build: jenkins-data
# restart: unless-stopped

master:
 build: jenkins-master
 volumes_from:
  - data
 ports:
  - "50006:50000"

nginx:
 build: jenkins-nginx
 ports:
  - "86:80"
 links:
  - master:jenkins-master
       # set the url of the link to http://jenkinsmaster:8080 (for conf discovery)
 volumes:
  - ./jenkins-nginx/logs/:/var/log/nginx/
 command: [nginx-debug, '-g', 'daemon off;']
slave:
  build: jenkins-slave